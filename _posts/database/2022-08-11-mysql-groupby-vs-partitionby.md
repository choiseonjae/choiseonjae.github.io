---
title: \[DB] Group Byì™€ Partition Byì˜ ìœ ì‚¬ì  ë° ì°¨ì´ì  

header:
  teaser: https://cdn.imweb.me/thumbnail/20200915/a0c073d00397a.png

categories: database
   
tags:
   - database
   - group by
   - partition by
   - over
   - order by
   - mysql

last_modified_at: 2023-01-01 01:33:00 

---

ê³„ì • / ì•½ê´€ ê´€ë ¨ ì—…ë¬´ë¥¼ í•˜ë‹¤ë³´ë©´ ë‹¤ë¥¸ ì„œë¹„ìŠ¤íŒ€ìœ¼ë¡œë¶€í„° ë¬¸ì˜ ë° ìš”ì²­ì´ ë“¤ì–´ì˜¨ë‹¤. ì´ë²ˆì— ë³µì¡í•˜ê²Œ ê¼¬ì—¬ì„œ ë°ì´í„° ì¶”ì¶œì„ í•˜ê¸° ê¹Œë‹¤ë¡œìš´ ê²½ìš°ê°€ ìƒê²¼ëŠ”ë° ì´ ë•Œ, group byë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆì—ˆë‹¤. group byë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì¶”ì¶œí•  ë•Œ ìƒì–´ë²„ë¦¬ëŠ” ë°ì´í„°ê°€ ë§ì•„ ì—¬ëŸ¬ë²ˆ sub queryë¥¼ ë§Œë“¤ì–´ ì¡°íšŒë¥¼ í–ˆëŠ”ë°, partition byë¥¼ ì´ìš©í•˜ë‹ˆ ì •ë§ ê°„ë‹¨í•˜ê²Œ ì¶”ì¶œí•  ìˆ˜ ìˆì—ˆë‹¤.

ë¹„ìŠ·í•˜ì§€ë§Œ ë‹¤ë¥¸ `Group By vs Partition By` ì •ë¦¬ë¥¼ í•´ë³¸ë‹¤.

ë“¤ì–´ê°€ê¸°ì „ì— ì•ì¨ì„œ ê°„ë‹¨í•˜ê²Œ ìš”ì•½í•˜ìë©´ ë‘˜ì˜ ìœ ì‚¬ì ê³¼ ì°¨ì´ì ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- ìœ ì‚¬ì ì€ ë°ì´í„°ë¥¼ ê·¸ë£¹í™” í•œë‹¤ëŠ” ì ì—ì„œ ìœ ì‚¬í•˜ë‹¤.
- ì°¨ì´ì ì€ `Group By`ëŠ” ê·¸ë£¹í™”í•˜ëŠ” ê³¼ì •ì—ì„œ ìƒì„¸ ë°ì´í„°ë¥¼ ìƒì‹¤í•˜ê²Œ ë˜ê³ , `Partition By`ëŠ” ìƒì„¸ë°ì´í„°ê°€ ìœ ì§€ëœë‹¤ëŠ” ì ì´ë‹¤.

# Group By vs Partition By

## Group By

ë™ì¼í•œ ê°’ ì—¬ëŸ¬ ê°œë¥¼ ê°€ì§€ê³  ìˆëŠ” ì—´ì˜ ì´ë¦„ í˜¹ì€ ì´ë¦„ë“¤ì„ Group By ì ˆì— ì ì–´ì¤Œìœ¼ë¡œì¨ ê·¸ ì—´(ë“¤)ì´ ê°€ì§€ê³  ìˆëŠ” ê°’ì´ ë™ì¼í•œ ê²½ìš°ë¼ë¦¬ ê·¸ë£¹ì„ ì§€ê²Œëœë‹¤. ì´ë•Œ, ì§‘ê³„ í•¨ìˆ˜ë¥¼ í†µí•´ ê°’ì„ í•©ì¹˜ëŠ” ê³¼ì •ì—ì„œ ë™ì¼í•œ ê°’ì„ í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ í•©ì¹˜ê³  ê·¸ í–‰ë“¤ì˜ ê°’ì„ ê³„ì‚°í•œë‹¤. ì§‘ê³„ í•¨ìˆ˜ë¥¼ í•©ì¹˜ëŠ” ê³¼ì •ì—ì„œ ê¸°ì¡´ì˜ í–‰ë“¤ì€ ì‚¬ë¼ì§€ê²Œ ëœë‹¤. ì§‘ê³„ í•¨ìˆ˜ë¥¼ í†µí•œ ê°’ê³¼ Group By ì ˆì— ìˆë˜ columnë“¤ì€ ë³¼ ìˆ˜ ìˆì–´ë„ ê¸°ì¡´ì˜ ë‚˜ë¨¸ì§€ ì •ë³´ëŠ” ë³¼ ìˆ˜ ì—†ë‹¤.

ë¬¼ë¡ , ì„œë¸Œ ì¿¼ë¦¬ë¥¼ í†µí•´ í•´ê²°í•  ìˆ˜ ìˆì§€ë§Œ ê·¸ë ‡ê²Œ í•˜ë‹¤ë³´ë©´ ì¿¼ë¦¬ë¬¸ ìì²´ê°€ ê¸¸ì–´ì§€ëŠ” ë‹¨ì ì´ ìˆë‹¤.
ì§‘ê³„ í•©ìˆ˜ì—ì„œ ìì£¼ ì‚¬ìš©ë˜ëŠ” í•¨ìˆ˜ë“¤ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

| ì§‘ê³„ í•¨ìˆ˜ | ì˜ë¯¸ |
| --- | --- |
| COUNT | ê°™ì€ ì—´(ë“¤)ì˜ ê°œìˆ˜ë¥¼ ì„¼ë‹¤. |
| SUM | ê°™ì€ ì—´(ë“¤)ì˜ ê°’ì˜ í•© |
| AVG | ê°™ì€ ì—´(ë“¤)ì˜ ê°’ì˜ í‰ê·  |
| MIN | ê°™ì€ ì—´(ë“¤) ì¤‘ ìµœì†Œ ê°’ |
| MAX | ê°™ì€ ì—´(ë“¤) ì¤‘ ìµœëŒ€ ê°’ |

```sql
SELECT status_cd, count(*) // status_cd ê°’ê³¼ ê·¸ ì§‘ê³„í•¨ìˆ˜ì˜ ê²°ê³¼ë§Œ ì•Œìˆ˜ ìˆë‹¤.
FROM user
GROUP BY status_cd // status_cd ê¸°ì¤€ìœ¼ë¡œ ì¤‘ë³µì—†ê²Œ rowê°€ ìƒì„±ë˜ê³ , ê·¸ ê°’ë“¤ì˜ counting ê°’ì´ ì¶œë ¥ëœë‹¤.
having count(*) > 10; // counting ëœ ê°’ì´ 10 ì´ìƒì¸ ê²ƒë§Œ ì¶œë ¥í•œë‹¤.
```

## Partition By

`Partition By`ëŠ” `Group By`ë³´ë‹¤ ë³µì¡í•œ ë¶„ì„ì„ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” SQL êµ¬ë¬¸ì´ë‹¤.

`Partition By`ëŠ” `OVER`ì ˆê³¼ ìœˆë„ìš° í•¨ìˆ˜ì™€ í•¨ê»˜ ì‚¬ìš©ëœë‹¤. ìœ„ì—ì„œë„ ë§í–ˆì§€ë§Œ, `Partition By`ëŠ” ê¸°ì¡´ í–‰ì˜ ì„¸ì„¸í•œ ì •ë³´ë“¤ì´ ì‚¬ë¼ì§€ì§€ ì•Šê³  ê·¸ëŒ€ë¡œ ìœ ì§€ëœë‹¤. ë˜í•œ, ëª¨ë“  ì§‘ê³„ í•¨ìˆ˜ë¥¼ ìœˆë„ìš° í•¨ìˆ˜ë¥¼ í†µí•´ ë™ì¼í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

{% capture content %}
ğŸ’¡ ì§‘ê³„ í•¨ìˆ˜ì™€ ìœˆë„ìš° í•¨ìˆ˜ì˜ ì°¨ì´ì 

ì§‘ê³„ í•¨ìˆ˜ëŠ” ì—¬ëŸ¬ í–‰ì˜ ìˆ˜ì¹˜ë¥¼ ë‹¨ 1ê°œì˜ ìˆ˜ì¹˜ë¡œ ë°˜í™˜í•œë‹¤.
ìœˆë„ìš° í•¨ìˆ˜ëŠ” ê° í–‰ë§ˆë‹¤ 1ê°œì˜ ê°’ì„ ë°˜í™˜í•œë‹¤. ìœˆë„ìš° í•¨ìˆ˜ëŠ” ê¸°ì¡´ì˜ ë°ì´í„°ì—ëŠ” ì•„ë¬´ëŸ° ë³€í™”ë¥¼ ì£¼ì§€ ì•Šì€ ìƒíƒœì—ì„œ, ìƒˆë¡œìš´ ì—´ì— ë°˜í™˜í•  ê°’ì„ ê³„ì‚°í•˜ê³ ì ì§‘ê³„ í•¨ìˆ˜ë¥¼ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ëŠ” ìˆë‹¤. ì§‘ê³„ í•¨ìˆ˜ë¥¼ ì¨ë„ ë˜ê³  ê·¸ëƒ¥ ìœˆë„ìš° í•¨ìˆ˜ë¥¼ ì¨ë„ ëœë‹¤.

{% endcapture %}

{% include notice--info title="" content=content %}

```sql
select R.id, R.name, R.birthday
from (
	select *, row_number() over (partition by name order by id) as rownumber from user
) R
where R.rownumber = 1; // nameê°€ ê°™ì€ ê·¸ë£¹ id ê¸°ì¤€ìœ¼ë¡œ í–‰ë²ˆí˜¸ë¥¼ ë¶™ì¸ë’¤ì— í–‰ë²ˆí˜¸ê°€ 1ë²ˆì„ ì¶”ì¶œ

------------------------------------------------------------------------

select R.id, R.name, R.birthday
from (
	select *, row_number() over (order by id) as rownumber from user
) R
where R.rownumber = 1; // ì „ì²´ ê·¸ë£¹ì„ id ê¸°ì¤€ìœ¼ë¡œ í–‰ë²ˆí˜¸ë¥¼ ë¶™ì¸ë’¤ì— í–‰ë²ˆí˜¸ê°€ 1ë²ˆì„ ì¶”ì¶œ

------------------------------------------------------------------------

select R.id, R.name, R.birthday
from (
	select *, rank() over (order by score) as rownumber from user
) R
where R.rownumber = 1; // ì „ì²´ ê·¸ë£¹ì„ score(ì ìˆ˜) ê¸°ì¤€ìœ¼ë¡œ ìˆœìœ„ë¥¼ ë§¤ê¸´ë’¤ 1ë²ˆì„ ì¶”ì¶œ. ë§Œì•½, 1ë²ˆì´ ë‘ëª…ì´ë¼ë©´ ë‘ëª…ì´ ì¶”ì¶œë˜ê³ , ë‹¤ìŒ ë“±ìˆ˜ëŠ” 3ë“±ìœ¼ë¡œ í‘œê¸°ëœë‹¤.

------------------------------------------------------------------------

select R.id, R.name, R.birthday
from (
	select *, dense_rank() over (order by score) as rownumber from user
) R
where R.rownumber = 1; // ì „ì²´ ê·¸ë£¹ì„ score(ì ìˆ˜) ê¸°ì¤€ìœ¼ë¡œ ìˆœìœ„ë¥¼ ë§¤ê¸´ë’¤ 1ë²ˆì„ ì¶”ì¶œ. ë§Œì•½, 1ë²ˆì´ ë‘ëª…ì´ë¼ë©´ ë‘ëª…ì´ ì¶”ì¶œë˜ê³ , ë‹¤ìŒ ë“±ìˆ˜ëŠ” 2ë“±ìœ¼ë¡œ í‘œê¸°ëœë‹¤.

------------------------------------------------------------------------

select R.id, R.name, R.birthday
from (
	select *, lead(name) over (order by birthday) as next_person_birthday from user
) R
// ì „ì²´ê·¸ë£¹ì—ì„œ birthday ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ë˜ì—ˆì„ ë•Œ í˜„ì¬ ì—´ì˜ ë‹¤ìŒì—´ì˜ name ê°’ì„ next_person_birthdayì— ë„£ëŠ”ë‹¤.

------------------------------------------------------------------------

select R.id, R.name, R.birthday
from (
	select *, lag(name) over (order by birthday) as next_person_birthday from user
) R
// ì „ì²´ê·¸ë£¹ì—ì„œ birthday ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ë˜ì—ˆì„ ë•Œ í˜„ì¬ ì—´ì˜ ì´ì „ ì—´ì˜ name ê°’ì„ next_person_birthdayì— ë„£ëŠ”ë‹¤.

------------------------------------------------------------------------

select R.id, R.name, R.birthday
from (
	select *, sum(score) over (order by birthday) as score_total from user
) R
// ì „ì²´ê·¸ë£¹ì—ì„œ birthday ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ë˜ì—ˆì„ ë•Œ ëˆ„ì ìœ¼ë¡œ score ì ìˆ˜ì˜ í•©ì„ ë„£ëŠ”ë‹¤. (íŠ¹ì§•ì€ ëˆ„ì ì´ë‹¤)

------------------------------------------------------------------------

select R.id, R.name, R.birthday
from (
	select *, count(score) over (order by birthday) as score_total from user
) R
// ì „ì²´ê·¸ë£¹ì—ì„œ birthday ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ë˜ì—ˆì„ ë•Œ ëˆ„ì ìœ¼ë¡œ score ì ìˆ˜ì˜ ê°¯ìˆ˜ë¥¼ êµ¬í•œë‹¤. (íŠ¹ì§•ì€ ëˆ„ì ì´ë‹¤)
```

| ì§‘ê³„ í•¨ìˆ˜ | ì˜ë¯¸                                                                                                                                                                                              |
| --- |-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| row_number() | over(order by [column])ì´ ê³ ì •ìœ¼ë¡œ ë‚˜ì˜¨ë‹¤. **order by ê¸°ì¤€ìœ¼ë¡œ í–‰ì˜ ë²ˆí˜¸**ë¥¼ ë¶™ì¸ë‹¤. over(partition by [column] order by [column]) ì²˜ëŸ¼ partition byë¥¼ ë¶™ì´ë©´ columnì—ì„œ ê°™ì€ ê°’ë¼ë¦¬ ê·¸ë£¹í•‘ í•œ ë’¤ì— í–‰ ë²ˆí˜¸ë¥¼ ë¶™ì¸ë‹¤.                             |
| rank | over(order by [column]) ê¸°ì¤€ìœ¼ë¡œ ìˆœìœ„ë¥¼ ë§¤ê¸´ë‹¤. **1ë“±ì´ ë‘ëª… ë‚˜ì˜¤ë©´ ë‹¤ìŒ ë“±ìˆ˜ëŠ” 3**ë“±ë¶€í„° ì‹œì‘ì´ë‹¤. over(partition by [column] order by [column]) ì²˜ëŸ¼ partition byë¥¼ ë¶™ì´ë©´ columnì—ì„œ ê°™ì€ ê°’ë¼ë¦¬ ê·¸ë£¹í•‘ í•œ ë’¤ì— ìˆœìœ„ë¥¼ ë¶™ì¸ë‹¤.                         |
| dense_rank | over(order by [column]) ê¸°ì¤€ìœ¼ë¡œ ìˆœìœ„ë¥¼ ë§¤ê¸´ë‹¤. **1ë“±ì´ ë‘ëª… ë‚˜ì˜¤ë©´ ë‹¤ìŒ ë“±ìˆ˜ëŠ” 2**ë“±ë¶€í„° ì‹œì‘ì´ë‹¤. over(partition by [column] order by [column]) ì²˜ëŸ¼ partition byë¥¼ ë¶™ì´ë©´ columnì—ì„œ ê°™ì€ ê°’ë¼ë¦¬ ê·¸ë£¹í•‘ í•œ ë’¤ì— ìˆœìœ„ë¥¼ ë¶™ì¸ë‹¤.                         |
| lead | lead(column) over (order by [column]) columnìœ¼ë¡œ ì •ë ¬ë˜ì—ˆì„ ë•Œ, **ì •ë ¬ ìˆœì„œë¡œ ë‹¤ìŒ ì—´(ë‹¤ìŒ ê°’)**ì˜ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.  over(partition by [column] order by [column]) ì²˜ëŸ¼ partition byë¥¼ ë¶™ì´ë©´ columnì—ì„œ ê°™ì€ ê°’ë¼ë¦¬ ê·¸ë£¹í•‘ í•œ ë°ì´í„° ë‚´ì—ì„œ ê°€ì ¸ì˜¨ë‹¤.     |
| lag | lead(column) over (order by [column]) columnìœ¼ë¡œ ì •ë ¬ë˜ì—ˆì„ ë•Œ, **ì •ë ¬ ìˆœì„œë¡œ ì•ì˜ ì—´(ì´ì „ ê°’)**ì˜ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.  over(partition by [column] order by [column]) ì²˜ëŸ¼ partition byë¥¼ ë¶™ì´ë©´ columnì—ì„œ ê°™ì€ ê°’ë¼ë¦¬ ê·¸ë£¹í•‘ í•œ ë°ì´í„° ë‚´ì—ì„œ ê°€ì ¸ì˜¨ë‹¤. |
| sum | sum(column) over (order by [column]) columnìœ¼ë¡œ ì •ë ¬ë˜ì—ˆì„ ë•Œ, sum ì•ˆì— ìˆëŠ” column ê°’ì´ **ëˆ„ì **ìœ¼ë¡œ ì¶”ì¶œëœë‹¤.                                                                                                       |
| count | count(column) over (order by [column]) columnìœ¼ë¡œ ì •ë ¬ë˜ì—ˆì„ ë•Œ, count ì•ˆì— ìˆëŠ” column **ê°’ì´** ëˆ„ì ìœ¼ë¡œ countingëœë‹¤.                                                                                             |

# ì •ë¦¬

group byë¥¼ ì‚¬ìš©í•œë‹¤ê³  partition byì—ì„œ ì¶”ì¶œí•  ìˆ˜ ìˆëŠ” ê°’ì„ ëª» ì–»ëŠ”ê±´ ì•„ë‹ˆë‹¤. ì¦‰, ë‘˜ë‹¤ ì›í•˜ëŠ” ê°’ì„ ì¶”ì¶œí•  ìˆ˜ ìˆëŠ” ê±´ ë™ì¼í•˜ë‹¤. í•˜ì§€ë§Œ, group byì˜ ê²½ìš°, ê¸°ì¡´ ë°ì´í„°ë¥¼  ìƒì–´ë²„ë¦¬ë©´ì„œ ìƒˆë¡œìš´ ê°’ì„ êµ¬í•˜ê¸° ë•Œë¬¸ì— ì›í•˜ëŠ” ê°’ì„ êµ¬í•˜ê¸° ìœ„í•´ì„œ ì„œë¸Œ ì¿¼ë¦¬ë¥¼ ê¸¸ê²Œ ì‘ì„±í•˜ê²Œ ë  ìˆ˜ ìˆë‹¤.

1. ìœ ì‚¬ì ì€ ì—´ë“¤ì˜ ê°’ì„ ê·¸ë£¹í•‘í•˜ì—¬ ê²°ê³¼ë¬¼ì„ ê°€ì ¸ì˜¨ë‹¤.
2. ì°¨ì´ì ì€ ê¸°ì¡´ ê°’ì„ ìƒì–´ë²„ë¦¬ì§€ ì•Šê³  êµ¬í•˜ê³  ì‹¶ìœ¼ë©´, partition byë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.
3. partition byëŠ” ìœˆë„ìš° í•¨ìˆ˜ + ì§‘ê³„ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ, group byëŠ” ì§‘ê³„ í•¨ìˆ˜ë§Œ ì‚¬ìš©í•œë‹¤.

## ì¶œì²˜
- [GROUP BY vs. PARTITION BY: ìœ ì‚¬ì ê³¼ ì°¨ì´ì ](https://kimsyoung.tistory.com/entry/GROUP-BY-vs-PARTITION-BY-%EC%9C%A0%EC%82%AC%EC%A0%90%EA%B3%BC-%EC%B0%A8%EC%9D%B4%EC%A0%90)
